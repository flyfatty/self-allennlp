2021-02-27 15:52:03,008 - INFO - allennlp.common.params - random_seed = 13370
2021-02-27 15:52:03,009 - INFO - allennlp.common.params - numpy_seed = 1337
2021-02-27 15:52:03,009 - INFO - allennlp.common.params - pytorch_seed = 133
2021-02-27 15:52:03,010 - INFO - allennlp.common.checks - Pytorch version: 1.7.1
2021-02-27 15:52:03,011 - INFO - allennlp.common.params - type = default
2021-02-27 15:52:03,012 - INFO - allennlp.common.params - dataset_reader.type = cls_tsv_dataset_reader
2021-02-27 15:52:03,012 - INFO - allennlp.common.params - dataset_reader.lazy = False
2021-02-27 15:52:03,012 - INFO - allennlp.common.params - dataset_reader.cache_directory = None
2021-02-27 15:52:03,012 - INFO - allennlp.common.params - dataset_reader.max_instances = None
2021-02-27 15:52:03,012 - INFO - allennlp.common.params - dataset_reader.manual_distributed_sharding = False
2021-02-27 15:52:03,013 - INFO - allennlp.common.params - dataset_reader.manual_multi_process_sharding = False
2021-02-27 15:52:03,013 - INFO - allennlp.common.params - dataset_reader.tokenizer.type = jieba
2021-02-27 15:52:03,013 - INFO - allennlp.common.params - dataset_reader.tokenizer.pos_tags = False
2021-02-27 15:52:03,014 - INFO - allennlp.common.params - dataset_reader.tokenizer.user_dict = None
2021-02-27 15:52:03,014 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.type = single_id
2021-02-27 15:52:03,014 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.namespace = tokens
2021-02-27 15:52:03,014 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.lowercase_tokens = False
2021-02-27 15:52:03,014 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.start_tokens = None
2021-02-27 15:52:03,015 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.end_tokens = None
2021-02-27 15:52:03,015 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.feature_name = text
2021-02-27 15:52:03,015 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.default_value = THIS IS A REALLY UNLIKELY VALUE THAT HAS TO BE A STRING
2021-02-27 15:52:03,015 - INFO - allennlp.common.params - dataset_reader.token_indexer.tokens.token_min_padding_length = 0
2021-02-27 15:52:03,016 - INFO - allennlp.common.params - dataset_reader.max_tokens = None
2021-02-27 15:52:03,016 - INFO - allennlp.common.params - dataset_reader.label_first = False
2021-02-27 15:52:03,016 - INFO - allennlp.common.params - dataset_reader.limit = -1
2021-02-27 15:52:03,016 - INFO - allennlp.common.params - train_data_path = /home/liubin/tutorials/data/action_desc/train.tsv
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - vocabulary = <allennlp.common.lazy.Lazy object at 0x7f5422240588>
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - datasets_for_vocab_creation = None
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - validation_dataset_reader = None
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - validation_data_path = /home/liubin/tutorials/data/action_desc/valid.tsv
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - validation_data_loader = None
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - test_data_path = None
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - evaluate_on_test = False
2021-02-27 15:52:03,017 - INFO - allennlp.common.params - batch_weight_key = 
2021-02-27 15:52:03,017 - INFO - allennlp.training.util - Reading training data from /home/liubin/tutorials/data/action_desc/train.tsv
2021-02-27 15:52:03,018 - INFO - tqdm - reading instances: 0it [00:00, ?it/s]
2021-02-27 15:52:13,029 - INFO - tqdm - reading instances: 32193it [00:10, 2764.47it/s]
2021-02-27 15:52:15,875 - INFO - allennlp.training.util - Reading validation data from /home/liubin/tutorials/data/action_desc/valid.tsv
2021-02-27 15:52:15,876 - INFO - tqdm - reading instances: 0it [00:00, ?it/s]
2021-02-27 15:52:17,900 - INFO - allennlp.common.params - type = from_instances
2021-02-27 15:52:17,900 - INFO - allennlp.common.params - min_count = None
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - max_vocab_size = None
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - non_padded_namespaces = ('*tags', '*labels')
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - pretrained_files = None
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - only_include_pretrained_words = False
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - tokens_to_add = None
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - min_pretrained_embeddings = None
2021-02-27 15:52:17,901 - INFO - allennlp.common.params - padding_token = @@PADDING@@
2021-02-27 15:52:17,902 - INFO - allennlp.common.params - oov_token = @@UNKNOWN@@
2021-02-27 15:52:17,902 - INFO - allennlp.data.vocabulary - Fitting token dictionary from dataset.
2021-02-27 15:52:17,902 - INFO - tqdm - building vocab: 0it [00:00, ?it/s]
2021-02-27 15:52:19,096 - INFO - allennlp.common.params - model.type = basic_classifier_f
2021-02-27 15:52:19,096 - INFO - allennlp.common.params - model.text_field_embedder.type = basic
2021-02-27 15:52:19,097 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.type = embedding
2021-02-27 15:52:19,097 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.embedding_dim = 200
2021-02-27 15:52:19,097 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.num_embeddings = None
2021-02-27 15:52:19,097 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.projection_dim = None
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.weight = None
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.padding_index = None
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.trainable = True
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.max_norm = None
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.norm_type = 2.0
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.scale_grad_by_freq = False
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.sparse = False
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.vocab_namespace = tokens
2021-02-27 15:52:19,098 - INFO - allennlp.common.params - model.text_field_embedder.token_embedders.tokens.pretrained_file = /home/liubin/tutorials/data/action_desc/embedding.h5
2021-02-27 15:52:19,350 - INFO - allennlp.common.params - model.seq2vec_encoder.type = stacked_bidirectional_lstm
2021-02-27 15:52:19,351 - INFO - allennlp.common.params - model.seq2vec_encoder.input_size = 200
2021-02-27 15:52:19,351 - INFO - allennlp.common.params - model.seq2vec_encoder.hidden_size = 256
2021-02-27 15:52:19,351 - INFO - allennlp.common.params - model.seq2vec_encoder.num_layers = 2
2021-02-27 15:52:19,351 - INFO - allennlp.common.params - model.seq2vec_encoder.recurrent_dropout_probability = 0.0
2021-02-27 15:52:19,351 - INFO - allennlp.common.params - model.seq2vec_encoder.layer_dropout_probability = 0.2
2021-02-27 15:52:19,352 - INFO - allennlp.common.params - model.seq2vec_encoder.use_highway = True
2021-02-27 15:52:20,099 - INFO - allennlp.common.params - model.seq2seq_encoder = None
2021-02-27 15:52:20,099 - INFO - allennlp.common.params - model.feedforward = None
2021-02-27 15:52:20,099 - INFO - allennlp.common.params - model.dropout = None
2021-02-27 15:52:20,099 - INFO - allennlp.common.params - model.num_labels = None
2021-02-27 15:52:20,099 - INFO - allennlp.common.params - model.label_namespace = labels
2021-02-27 15:52:20,102 - INFO - allennlp.common.params - model.namespace = tokens
2021-02-27 15:52:20,102 - INFO - allennlp.common.params - model.initializer = <allennlp.nn.initializers.InitializerApplicator object at 0x7f5422113390>
2021-02-27 15:52:20,103 - INFO - allennlp.common.params - model.f_beta = 1
2021-02-27 15:52:20,104 - INFO - allennlp.nn.initializers - Initializing parameters
2021-02-27 15:52:20,104 - INFO - allennlp.nn.initializers - Done initializing parameters; the following parameters are using their default initialization from their code
2021-02-27 15:52:20,104 - INFO - allennlp.nn.initializers -    _classification_layer.bias
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _classification_layer.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_0.cell.input_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_0.cell.state_linearity.bias
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_0.cell.state_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_1.cell.input_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_1.cell.state_linearity.bias
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.backward_layer_1.cell.state_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_0.cell.input_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_0.cell.state_linearity.bias
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_0.cell.state_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_1.cell.input_linearity.weight
2021-02-27 15:52:20,105 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_1.cell.state_linearity.bias
2021-02-27 15:52:20,106 - INFO - allennlp.nn.initializers -    _seq2vec_encoder._module.forward_layer_1.cell.state_linearity.weight
2021-02-27 15:52:20,106 - INFO - allennlp.nn.initializers -    _text_field_embedder.token_embedder_tokens.weight
2021-02-27 15:52:20,277 - INFO - allennlp.common.params - data_loader.type = pytorch_dataloader
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.batch_size = 32
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.shuffle = True
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.sampler = None
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.batch_sampler = None
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.num_workers = 0
2021-02-27 15:52:20,278 - INFO - allennlp.common.params - data_loader.pin_memory = False
2021-02-27 15:52:20,279 - INFO - allennlp.common.params - data_loader.drop_last = False
2021-02-27 15:52:20,279 - INFO - allennlp.common.params - data_loader.timeout = 0
2021-02-27 15:52:20,279 - INFO - allennlp.common.params - data_loader.worker_init_fn = None
2021-02-27 15:52:20,279 - INFO - allennlp.common.params - data_loader.multiprocessing_context = None
2021-02-27 15:52:20,279 - INFO - allennlp.common.params - data_loader.batches_per_epoch = None
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.type = pytorch_dataloader
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.batch_size = 32
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.shuffle = True
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.sampler = None
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.batch_sampler = None
2021-02-27 15:52:20,280 - INFO - allennlp.common.params - data_loader.num_workers = 0
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.pin_memory = False
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.drop_last = False
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.timeout = 0
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.worker_init_fn = None
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.multiprocessing_context = None
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - data_loader.batches_per_epoch = None
2021-02-27 15:52:20,281 - INFO - allennlp.common.params - trainer.type = gradient_descent
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.patience = None
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.validation_metric = -loss
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.num_epochs = 5
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.cuda_device = None
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.grad_norm = None
2021-02-27 15:52:20,282 - INFO - allennlp.common.params - trainer.grad_clipping = None
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.distributed = False
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.world_size = 1
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.num_gradient_accumulation_steps = 1
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.use_amp = False
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.no_grad = None
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.optimizer = adam
2021-02-27 15:52:20,283 - INFO - allennlp.common.params - trainer.learning_rate_scheduler = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.momentum_scheduler = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.tensorboard_writer = <allennlp.common.lazy.Lazy object at 0x7f542228ae48>
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.moving_average = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.checkpointer = <allennlp.common.lazy.Lazy object at 0x7f542229d0b8>
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.batch_callbacks = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.epoch_callbacks = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.end_callbacks = None
2021-02-27 15:52:20,284 - INFO - allennlp.common.params - trainer.trainer_callbacks = None
2021-02-27 15:52:20,285 - INFO - allennlp.common.params - type = adam
2021-02-27 15:52:20,285 - INFO - allennlp.common.params - parameter_groups = None
2021-02-27 15:52:20,285 - INFO - allennlp.common.params - lr = 0.001
2021-02-27 15:52:20,285 - INFO - allennlp.common.params - betas = (0.9, 0.999)
2021-02-27 15:52:20,286 - INFO - allennlp.common.params - eps = 1e-08
2021-02-27 15:52:20,286 - INFO - allennlp.common.params - weight_decay = 0.0
2021-02-27 15:52:20,286 - INFO - allennlp.common.params - amsgrad = False
2021-02-27 15:52:20,286 - INFO - allennlp.training.optimizers - Number of trainable parameters: 18121330
2021-02-27 15:52:20,287 - INFO - allennlp.common.util - The following parameters are Frozen (without gradient):
2021-02-27 15:52:20,287 - INFO - allennlp.common.util - The following parameters are Tunable (with gradient):
2021-02-27 15:52:20,287 - INFO - allennlp.common.util - _text_field_embedder.token_embedder_tokens.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_0.cell.input_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_0.cell.state_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_0.cell.state_linearity.bias
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_0.cell.input_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_0.cell.state_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_0.cell.state_linearity.bias
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_1.cell.input_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_1.cell.state_linearity.weight
2021-02-27 15:52:20,288 - INFO - allennlp.common.util - _seq2vec_encoder._module.forward_layer_1.cell.state_linearity.bias
2021-02-27 15:52:20,289 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_1.cell.input_linearity.weight
2021-02-27 15:52:20,289 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_1.cell.state_linearity.weight
2021-02-27 15:52:20,289 - INFO - allennlp.common.util - _seq2vec_encoder._module.backward_layer_1.cell.state_linearity.bias
2021-02-27 15:52:20,289 - INFO - allennlp.common.util - _classification_layer.weight
2021-02-27 15:52:20,289 - INFO - allennlp.common.util - _classification_layer.bias
2021-02-27 15:52:20,289 - INFO - allennlp.common.params - type = default
2021-02-27 15:52:20,289 - INFO - allennlp.common.params - keep_serialized_model_every_num_seconds = None
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - num_serialized_models_to_keep = 2
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - model_save_interval = None
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - summary_interval = 100
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - histogram_interval = None
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - batch_size_interval = None
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - should_log_parameter_statistics = True
2021-02-27 15:52:20,290 - INFO - allennlp.common.params - should_log_learning_rate = False
2021-02-27 15:52:20,291 - INFO - allennlp.common.params - get_batch_num_total = None
2021-02-27 15:52:20,292 - WARNING - allennlp.training.trainer - You provided a validation dataset but patience was set to None, meaning that early stopping is disabled
2021-02-27 15:52:20,292 - INFO - allennlp.training.trainer - Beginning training.
2021-02-27 15:52:20,292 - INFO - allennlp.training.trainer - Epoch 0/4
2021-02-27 15:52:20,293 - INFO - allennlp.training.trainer - Worker 0 memory usage: 999M
2021-02-27 15:52:20,293 - INFO - allennlp.training.trainer - Training
2021-02-27 15:52:20,293 - INFO - tqdm - 0%|          | 0/1262 [00:00<?, ?it/s]
2021-02-27 15:52:32,115 - INFO - tqdm - accuracy: 0.7656, precision: 0.2143, recall: 0.0811, f1: 0.1176, batch_loss: 0.6911, loss: 0.5431 ||:   0%|          | 6/1262 [00:11<45:12,  2.16s/it]
2021-02-27 15:52:42,841 - INFO - tqdm - accuracy: 0.7986, precision: 0.2143, recall: 0.0600, f1: 0.0938, batch_loss: 0.3605, loss: 0.4742 ||:   1%|          | 9/1262 [00:22<1:06:52,  3.20s/it]
2021-02-27 15:52:59,104 - INFO - tqdm - accuracy: 0.8103, precision: 0.3684, recall: 0.0875, f1: 0.1414, batch_loss: 0.2188, loss: 0.4226 ||:   1%|1         | 14/1262 [00:38<1:16:28,  3.68s/it]
2021-02-27 15:53:10,187 - INFO - tqdm - accuracy: 0.8375, precision: 0.5909, recall: 0.2321, f1: 0.3333, batch_loss: 0.0725, loss: 0.3703 ||:   2%|1         | 20/1262 [00:49<43:37,  2.11s/it]
2021-02-27 15:53:20,597 - INFO - tqdm - accuracy: 0.8410, precision: 0.6027, recall: 0.3333, f1: 0.4293, batch_loss: 0.1474, loss: 0.3542 ||:   2%|1         | 23/1262 [01:00<58:15,  2.82s/it]
2021-02-27 15:53:31,702 - INFO - tqdm - accuracy: 0.8424, precision: 0.5897, recall: 0.3407, f1: 0.4319, batch_loss: 0.2290, loss: 0.3490 ||:   2%|1         | 24/1262 [01:11<1:49:29,  5.31s/it]
2021-02-27 15:53:42,781 - INFO - tqdm - accuracy: 0.8459, precision: 0.6190, recall: 0.3190, f1: 0.4211, batch_loss: 0.2807, loss: 0.3404 ||:   2%|2         | 29/1262 [01:22<54:34,  2.66s/it]
2021-02-27 15:53:53,562 - INFO - tqdm - accuracy: 0.8483, precision: 0.6000, recall: 0.3387, f1: 0.4330, batch_loss: 0.2961, loss: 0.3345 ||:   3%|2         | 34/1262 [01:33<49:18,  2.41s/it]
2021-02-27 15:54:07,678 - INFO - tqdm - accuracy: 0.8514, precision: 0.6186, recall: 0.3578, f1: 0.4534, batch_loss: 0.2345, loss: 0.3299 ||:   3%|2         | 37/1262 [01:47<59:15,  2.90s/it]
